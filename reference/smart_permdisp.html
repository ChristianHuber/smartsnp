<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Smart Permutational Multivariate Analysis of Dispersion — smart_permdisp • smartsnp</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Smart Permutational Multivariate Analysis of Dispersion — smart_permdisp" />
<meta property="og:description" content="Computes Permutational Multivariate Analysis of Dispersion (PERMDISP) in group dispersion using multivariate data.
Variance partitioning computed on a sample-by-sample triangular matrix obtained from variable-by-sample data following Anderson (2006).
Calculates a range of inter-sample distances, similarities and dissimilarities. Includes control for genetic drift for bi-allelic genetic markers including single nucleotide polymorphisms (SNP) following Patterson, Price and Reich (2006) that can be combined with SMART Principal Component Analysis (PCA).
Optimized to run fast matrix building and permutations for big datasets in ecological, evolutionary and genomic research." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">smartsnp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Converting_VCF_and_PLINK_formats.html">Using VCF and PLINK formatted files with smartsnp</a>
    </li>
    <li>
      <a href="../articles/aDNA_smartpca_analysis.html">Projecting ancient samples</a>
    </li>
    <li>
      <a href="../articles/mallard_smartpca_analysis.html">Example PCA, PERMANOVA and PERMDISP analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ChristianHuber/smartsnp/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Smart Permutational Multivariate Analysis of Dispersion</h1>
    <small class="dont-index">Source: <a href='https://github.com/ChristianHuber/smartsnp/blob/master/R/smart_permdisp.R'><code>R/smart_permdisp.R</code></a></small>
    <div class="hidden name"><code>smart_permdisp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes Permutational Multivariate Analysis of Dispersion (PERMDISP) in group dispersion using multivariate data.
Variance partitioning computed on a sample-by-sample triangular matrix obtained from variable-by-sample data following Anderson (2006).
Calculates a range of inter-sample distances, similarities and dissimilarities. Includes control for genetic drift for bi-allelic genetic markers including single nucleotide polymorphisms (SNP) following Patterson, Price and Reich (2006) that can be combined with SMART Principal Component Analysis (PCA).
Optimized to run fast matrix building and permutations for big datasets in ecological, evolutionary and genomic research.<br /></p>
    </div>


    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>snp_data</th>
      <td><p>File name read from working directory. SNP = rows, samples = columns without row names or column headings.
SNP values must be count data (no decimals allowed).
File extension detected automatically whether text or <code>EIGENSTRAT</code>.
See details.</p></td>
    </tr>
    <tr>
      <th>packed_data</th>
      <td><p>Logical value for <code>EIGENSTRAT</code>, irrelevant for text data.
Default <code>packed_data = FALSE</code> assumes uncompressed <code>EIGENSTRAT</code>.
<code>packed_data = TRUE</code> for compressed or binary <code>EIGENSTRAT</code> (<code>PACKENDANCESTRYMAP</code>).</p></td>
    </tr>
    <tr>
      <th>sample_group</th>
      <td><p>Character or numeric vector assigning samples to groups. Coerced to factor.</p></td>
    </tr>
    <tr>
      <th>sample_remove</th>
      <td><p>Logical <code>FALSE</code> or numeric vector indicating column numbers (samples) to be removed from computations.
Default <code>sample_remove =  FALSE</code> keeps all samples.</p></td>
    </tr>
    <tr>
      <th>snp_remove</th>
      <td><p>Logical <code>FALSE</code> or numeric vector indicating row numbers (SNPs) to be removed from computations.
Default <code>snp_remove =  FALSE</code> keeps all SNPs.
See details.</p></td>
    </tr>
    <tr>
      <th>missing_value</th>
      <td><p>Number <code>9</code> or string <code>NA</code> indicating missing value.
Default <code>missing_value = 9</code> as in <code>EIGENSTRAT</code>.
If no missing values present, no effect on computation.</p></td>
    </tr>
    <tr>
      <th>missing_impute</th>
      <td><p>String handling missing values.
Default <code>missing_impute = "mean"</code> replaces missing values of each SNP by mean of non-missing values across samples.
<code>missing_impute = "remove"</code> removes SNPs with at least one missing value.
If no missing values present, no effect on computation.</p></td>
    </tr>
    <tr>
      <th>scaling</th>
      <td><p>String. Default <code>scaling = "drift"</code> scales SNPs to control for expected allele frequency dispersion caused by genetic drift (SMARTPCA). <code>scaling = "center"</code> for <code>centering</code> (covariance-based PCA). <code>scaling = "sd"</code> for <code>centered</code> SNPs divided by standard deviation (correlation-based PCA).
<code>scaling = "none"</code> for no scaling.
See details.</p></td>
    </tr>
    <tr>
      <th>sample_distance</th>
      <td><p>Type of inter-sample proximity computed (distance, similarity, dissimilarity).
Default is <code>Euclidean distance</code>.
See details.</p></td>
    </tr>
    <tr>
      <th>program_distance</th>
      <td><p>A string value indicating R package to estimate proximities between pairs of samples.
Default <code>program_distance = "Rfast"</code> uses function <code><a href='https://rdrr.io/pkg/Rfast/man/Dist.html'>Dist</a></code>; <code>program_distance = "vegan"</code> uses <code><a href='https://rdrr.io/pkg/vegan/man/vegdist.html'>vegdist</a></code>.
See details.</p></td>
    </tr>
    <tr>
      <th>target_space</th>
      <td><p>String.
Default <code>target_space = "multidimensional"</code> applies PERMANOVA to sample-by-sample triangular matrix computed from variable-by-sample data, <code>pc_axes</code> has no effect on computation.
<code>target_space = "pca"</code> applies PERMANOVA to sample-by-sample data in PCA space, <code>pc_axes</code> determines number of PCA axes for testing.</p></td>
    </tr>
    <tr>
      <th>pc_axes</th>
      <td><p>Number of PCA axes computed always starting with PCA axis 1.
Default <code>pc_axes = 2</code> computes PCA axes 1 and 2 if <code>target_space = "pca"</code>.
No effect on computation if <code>target_space = "multidimensional"</code>.</p></td>
    </tr>
    <tr>
      <th>pairwise</th>
      <td><p>Logical.
Default <code>pairwise = FALSE</code> computes global test.
<code>pairwise = TRUE</code> computes global and pairwise tests.</p></td>
    </tr>
    <tr>
      <th>pairwise_method</th>
      <td><p>String specifying type of correction for multiple testing.
Default <code>"holm"</code>.
See details.</p></td>
    </tr>
    <tr>
      <th>permutation_n</th>
      <td><p>Number of permutations resulting in PERMDISP test <em>p value</em>.
Default <code>9999</code>.</p></td>
    </tr>
    <tr>
      <th>permutation_seed</th>
      <td><p>Number fixing random generator of permutations.
Default <code>1</code>.</p></td>
    </tr>
    <tr>
      <th>dispersion_type</th>
      <td><p>String indicating quantification of group dispersion whether relative to spatial <code>"median"</code> or <code>"centroid"</code>.
Default <code>"median"</code>. See details.</p></td>
    </tr>
    <tr>
      <th>samplesize_bias</th>
      <td><p>Logical.
<code>samplesize_bias = TRUE</code> for dispersion weighted by number of samples per group.
Default <code>samplesize_bias = FALSE</code> for no weighting.
See details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list containing the following elements:</p><ul>
<li><p>permdisp.samplesDataframe showing sample summary.
Column <em>Group</em> assigns samples to tested groups.
Column <em>Class</em> specifies if samples were used in, or removed from, testing (PERMDISP).
Column <em>Sample_dispersion</em> shows dispersion of individual samples relative to spatial <code>"median"</code> or <code>"centroid"</code>.</p></li>
<li><p>permdisp.biasString indicating if PERMDISP dispersions corrected for number of samples per group.</p></li>
<li><p>permdisp.group_locationDataframe showing coordinates of spatial <code>"median"</code> or <code>"centroid"</code> per group.</p></li>
<li><p>permdisp.global_testList showing table with degrees of freedom, sum of squares, mean sum of squares, <em>F</em> statistic and <em>p</em> value.</p></li>
<li><p>permdisp.pairwise_testList showing table with <em>F</em> statistic, <em>p</em> value and corrected <em>p</em> value per pair of groups.
Obtained only if <code>pairwise = TRUE</code>.</p></li>
<li><p>permdisp.pairwise_correctionString indicating type of correction for multiple testing.</p></li>
<li><p>permdisp.permutation_numberNumber of permutations applied to obtain the distribution of <em>F</em> statistic.</p></li>
<li><p>permdisp.permutation_seedNumber fixing random generator of permutations for reproducibility of results.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>PERMDISP is a form of <code>homoscedasticity</code> test analogous to univariate Levene's (1960) and, more closely, Brown &amp; Forsythe's (1974) tests. Applies PERMANOVA test (Anderson 2001) for differences in Euclidean dispersion among groups (Anderson 2006).
Proximity between samples can be any type of distance, similarity or dissimilarity.
Group dispersion estimated relative to group centroids (central point) or to spatial (geometric) medians (point minimizing distance to group samples) in Principal Coordinate Analysis (<code>PCoA</code>, Gower 1966) space.
Acronym PERMDISP originates from Marti Anderson's FORTRAN program (Anderson 2004).</p>
<p>Control for unequal number of samples among groups optionally done by weighting sample distance to group spatial <em>median</em> or  <em>centroid</em> by <em>sqrt(n/(n-1))</em> (O'Neill &amp; Mathews 2000), and the null hypothesis then being tested changes from <em>d_1 = d_2  = ... = d_t</em> (balanced design) to  <em>((n_1-1)/n_1) x d_1 = ((n_2-1)/n_2) x d_2  = ... =  ((n_t-1)/n_t) x d_t</em> (unbalanced design) where <em>d</em> represents dispersion of groups <em>1</em> to <em>t</em>, and <em>n</em> represents number of samples per group.
To attribute group differences to location (position of sample groups) and/or dispersion (spread of sample groups), PERMDISP must be combined with PERMANOVA as implemented through <code>smart_permanova</code>.<br /></p>
<p><code>smart_permdisp</code> uses <code><a href='https://rdrr.io/pkg/vegan/man/betadisper.html'>betadisper</a></code> to estimate an ANOVA <em>F</em> statistic and group dispersions using formula <code>snp_eucli ~ sample_group</code>, where <code>snp_eucli</code> is the sample-by-sample triangular matrix in <code>PCoA</code> space.
If &gt;2 sample groups tested, <code>pairwise = TRUE</code> allows pairwise testing and correction for multiple testing by <code>holm (Holm)</code> [default], <code>hochberg (Hochberg)</code>, <code>hommel (Hommel)</code>, <code>bonferroni (Bonferroni)</code>, <code>BY (Benjamini-Yekuieli)</code>, <code>BH (Benjamini-Hochberg)</code> or <code>fdr (False Discovery Rate)</code>.<br /></p>
<p>For big data, <code><a href='https://rdrr.io/pkg/Rfast/man/Dist.html'>Dist</a></code> builds sample-by-sample triangular matrix much faster than <code><a href='https://rdrr.io/pkg/vegan/man/vegdist.html'>vegdist</a></code>. <code><a href='https://rdrr.io/pkg/Rfast/man/Dist.html'>Dist</a></code> computes proximities <code>euclidean</code>, <code>manhattan</code>, <code>canberra1</code>, <code>canberra2</code>, <code>minimum</code>, <code>maximum</code>, <code>minkowski</code>, <code>bhattacharyya</code>, <code>hellinger</code>, <code>kullback_leibler</code> and <code>jensen_shannon</code>. <code><a href='https://rdrr.io/pkg/vegan/man/vegdist.html'>vegdist</a></code> computes <code>manhattan</code>, <code>euclidean</code>, <code>canberra</code>, <code>clark</code>, <code>bray</code>, <code>kulczynski</code>, <code>jaccard</code>, <code>gower</code>, <code>altGower</code>, <code>morisita</code>, <code>horn</code>, <code>mountford</code>, <code>raup</code>, <code>binomial</code>, <code>chao</code>, <code>cao</code> and <code>mahalanobis</code>.
Euclidean distance required for SMARTPCA scaling.<br /></p>
<p><code>sample_remove</code> should include both samples removed from PCA and ancient samples projected onto PCA space (if any).<br /></p>
<p>Data read from working directory with SNPs as rows and samples as columns. Two alternative formats: (1) text file of SNPs by samples (file extension and column separators recognized automatically) read using <code><a href='https://Rdatatable.gitlab.io/data.table/reference/fread.html'>fread</a></code>; or (2) duet of <code>EIGENSTRAT</code> files (see <a href='https://reich.hms.harvard.edu/software'>https://reich.hms.harvard.edu/software</a>) using <code><a href='https://vroom.r-lib.org/reference/vroom_fwf.html'>vroom_fwf</a></code>, including a genotype file of SNPs by samples <code>*.geno</code>, and a sample file (<code>*.ind</code>) containing three vectors assigning individual samples to unique user-predefined groups (populations), sexes (or other user-defined descriptor) and alphanumeric identifiers. For <code>EIGENSTRAT</code>, vector <code>sample_group</code> assigns samples to groups retrievable from column 3 of file <code>*.ind</code>.
SNPs with zero variance removed prior to SVD to optimize computation time and avoid undefined values if <code>scaling = "sd"</code> or <code>"drift"</code>.<br /></p>
<p>Users can select subsets of samples or SNPs by introducing a vector including column numbers for samples (<code>sample_remove</code>) and/or row numbers for SNPs (<code>snp_remove</code>) to be removed from computations.
Function stops if the final number of SNPs is 1 or 2.
<code>EIGENSOFT</code> was conceived for the analysis of human genes and its <code>SMARTPCA</code> suite so accepts 22 (autosomal) chromosomes by default.
If &gt;22 chromosomes are provided and the internal parameter <code>numchrom</code> is not set to the target number chromosomes of interest, SMARTPCA automatically subsets chromosomes 1 to 22.
In contrast, <code>smart_permdisp</code> accepts any number of autosomes with or without the sex chromosomes from an <code>EIGENSTRAT</code> file.<br /></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Anderson, M. J. (2001) A new method for non-parametric multivariate analysis of variance. Austral Ecology, 26, 32-46.<br />
Anderson, M. J. (2004). PERMANOVA_2factor: a FORTRAN computer program for permutational multivariate analysis of variance (for any two-factor ANOVA design) using permutation tests  (Department of Statistics, University of Auckland, New Zealand).<br />
Anderson, M. J. &amp; D. C. I. Walsh (2013) PERMANOVA, ANOSIM, and the Mantel test in the face of heterogeneous dispersions: What null hypothesis are you testing? Ecological Monographs, 83, 557-574.<br />
Gower, J. C. (1966) Some distance properties of latent root and vector methods used in multivariate analysis. Biometrika, 53, 325-338.<br />
McArdle, B. H. &amp; M. J. Anderson (2001) Fitting multivariate models to community data: a comment on distance-based redundancy analysis. Ecology, 82, 290-297.<br />
Patterson, N., A. L. Price and D. Reich (2006) Population structure and eigenanalysis. PLoS Genetics, 2, e190.<br />
Warton, D. I., S. T. Wright and Y. Wang (2012) Distance-based multivariate analyses confound location and dispersion effects. Methods in Ecology and Evolution, 3, 89-101.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/vegan/man/adonis.html'>adonis</a></code> (package <b>vegan</b>),
<code><a href='https://rdrr.io/pkg/Rfast/man/Dist.html'>Dist</a></code> (package <b>Rfast</b>),
<code><a href='https://Rdatatable.gitlab.io/data.table/reference/fread.html'>fread</a></code> (package <b>data.table</b>),
<code><a href='https://rdrr.io/pkg/vegan/man/vegdist.html'>vegdist</a></code> (package <b>vegan</b>),
<code><a href='https://vroom.r-lib.org/reference/vroom_fwf.html'>vroom_fwf</a></code> (package <b>vroom</b>)</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Path to example genotype matrix "dataSNP"</span>
<span class='va'>pathToGenoFile</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"dataSNP"</span>, package <span class='op'>=</span> <span class='st'>"smartsnp"</span><span class='op'>)</span>

<span class='co'># Assign 50 samples to each of two groups and colours</span>
<span class='va'>my_groups</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"A"</span>, <span class='fl'>50</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"B"</span>, <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>; <span class='va'>cols</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red"</span>, <span class='st'>"blue"</span><span class='op'>)</span>

<span class='co'># Run PERMDISP</span>
<span class='va'>permdispR</span> <span class='op'>&lt;-</span> <span class='fu'>smart_permdisp</span><span class='op'>(</span>snp_data <span class='op'>=</span> <span class='va'>pathToGenoFile</span>, sample_group <span class='op'>=</span> <span class='va'>my_groups</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Checking argument options selected...</span></div><div class='output co'>#&gt; <span class='message'>Argument options are correct...</span></div><div class='output co'>#&gt; <span class='message'>Loading data...</span></div><div class='output co'>#&gt; <span class='message'>Imported 10000 SNP by 100 sample genotype matrix</span></div><div class='output co'>#&gt; <span class='message'>Time elapsed: 0h 0m 0s</span></div><div class='output co'>#&gt; <span class='message'>Filtering data...</span></div><div class='output co'>#&gt; <span class='message'>10000 SNPs included in PERMDISP computation</span></div><div class='output co'>#&gt; <span class='message'>1 SNPs omitted from PCA computation</span></div><div class='output co'>#&gt; <span class='message'>100 samples included in PERMDISP computation</span></div><div class='output co'>#&gt; <span class='message'>Completed data filtering</span></div><div class='output co'>#&gt; <span class='message'>Time elapsed: 0h 0m 0s</span></div><div class='output co'>#&gt; <span class='message'>Scanning for invariant SNPs...</span></div><div class='output co'>#&gt; <span class='message'>Scan complete: no invariant SNPs found</span></div><div class='output co'>#&gt; <span class='message'>Time elapsed: 0h 0m 0s</span></div><div class='output co'>#&gt; <span class='message'>Checking for missing values...</span></div><div class='output co'>#&gt; <span class='message'>6341 SNPs contain missing values</span></div><div class='output co'>#&gt; <span class='message'>Imputing mean for SNPs with missing values...</span></div><div class='output co'>#&gt; <span class='message'>Imputation completed: 10058 missing values imputed</span></div><div class='output co'>#&gt; <span class='message'>Time elapsed: 0h 0m 0s</span></div><div class='output co'>#&gt; <span class='message'>Scaling values by SNP...</span></div><div class='output co'>#&gt; <span class='message'>Centering and scaling by drift dispersion...</span></div><div class='output co'>#&gt; <span class='message'>Completed scaling</span></div><div class='output co'>#&gt; <span class='message'>Time elapsed: 0h 0m 0s</span></div><div class='output co'>#&gt; <span class='message'>Construct triangular matrix of sample by sample proximities in multidimensional space...</span></div><div class='output co'>#&gt; <span class='message'>Completed construction of triangular matrix of sample by sample proximities...</span></div><div class='output co'>#&gt; <span class='message'>Compute inter- and intra-group dispersion by PERMDISP: global test...</span></div><div class='output co'>#&gt; <span class='message'>Completed PERMDISP: global test based on group spatial medians</span></div><div class='output co'>#&gt; <span class='message'>Time elapsed: 0h 0m 1s</span></div><div class='output co'>#&gt; <span class='message'>Tabulating PERMDISP outputs...</span></div><div class='output co'>#&gt; <span class='message'>Completed tabulations of PERMDISP outputs</span></div><div class='input'>
<span class='co'># Extract summary table assigning samples to groups and dispersion of individual samples</span>
<span class='va'>permdispR</span><span class='op'>$</span><span class='va'>permdisp.samples</span>
</div><div class='output co'>#&gt;     Group    Class Sample_dispersion
#&gt; 1       A PERMDISP          161.4757
#&gt; 2       A PERMDISP          160.9709
#&gt; 3       A PERMDISP          161.2118
#&gt; 4       A PERMDISP          160.3491
#&gt; 5       A PERMDISP          160.4445
#&gt; 6       A PERMDISP          162.2998
#&gt; 7       A PERMDISP          160.9662
#&gt; 8       A PERMDISP          160.9234
#&gt; 9       A PERMDISP          161.4040
#&gt; 10      A PERMDISP          161.1902
#&gt; 11      A PERMDISP          160.2838
#&gt; 12      A PERMDISP          161.0910
#&gt; 13      A PERMDISP          160.0616
#&gt; 14      A PERMDISP          161.9953
#&gt; 15      A PERMDISP          161.5489
#&gt; 16      A PERMDISP          160.8466
#&gt; 17      A PERMDISP          162.0203
#&gt; 18      A PERMDISP          161.0723
#&gt; 19      A PERMDISP          160.9892
#&gt; 20      A PERMDISP          161.2393
#&gt; 21      A PERMDISP          160.8561
#&gt; 22      A PERMDISP          160.8314
#&gt; 23      A PERMDISP          162.2363
#&gt; 24      A PERMDISP          160.9487
#&gt; 25      A PERMDISP          161.7043
#&gt; 26      A PERMDISP          160.0128
#&gt; 27      A PERMDISP          161.8192
#&gt; 28      A PERMDISP          160.7234
#&gt; 29      A PERMDISP          160.9490
#&gt; 30      A PERMDISP          160.7225
#&gt; 31      A PERMDISP          161.0558
#&gt; 32      A PERMDISP          160.7245
#&gt; 33      A PERMDISP          161.1502
#&gt; 34      A PERMDISP          159.9254
#&gt; 35      A PERMDISP          161.1662
#&gt; 36      A PERMDISP          161.3988
#&gt; 37      A PERMDISP          161.6969
#&gt; 38      A PERMDISP          160.5360
#&gt; 39      A PERMDISP          161.5771
#&gt; 40      A PERMDISP          161.1907
#&gt; 41      A PERMDISP          161.8498
#&gt; 42      A PERMDISP          161.7793
#&gt; 43      A PERMDISP          161.9005
#&gt; 44      A PERMDISP          161.7850
#&gt; 45      A PERMDISP          161.7027
#&gt; 46      A PERMDISP          161.9930
#&gt; 47      A PERMDISP          162.2773
#&gt; 48      A PERMDISP          160.8876
#&gt; 49      A PERMDISP          161.3201
#&gt; 50      A PERMDISP          162.0835
#&gt; 51      B PERMDISP          161.9058
#&gt; 52      B PERMDISP          161.5106
#&gt; 53      B PERMDISP          160.9970
#&gt; 54      B PERMDISP          160.9550
#&gt; 55      B PERMDISP          160.9942
#&gt; 56      B PERMDISP          162.4287
#&gt; 57      B PERMDISP          161.0528
#&gt; 58      B PERMDISP          161.0653
#&gt; 59      B PERMDISP          160.5475
#&gt; 60      B PERMDISP          161.4787
#&gt; 61      B PERMDISP          161.8445
#&gt; 62      B PERMDISP          161.1317
#&gt; 63      B PERMDISP          161.3229
#&gt; 64      B PERMDISP          162.3351
#&gt; 65      B PERMDISP          160.9433
#&gt; 66      B PERMDISP          161.8845
#&gt; 67      B PERMDISP          160.6879
#&gt; 68      B PERMDISP          160.8744
#&gt; 69      B PERMDISP          163.0843
#&gt; 70      B PERMDISP          160.7723
#&gt; 71      B PERMDISP          160.9731
#&gt; 72      B PERMDISP          161.2441
#&gt; 73      B PERMDISP          162.3827
#&gt; 74      B PERMDISP          161.2757
#&gt; 75      B PERMDISP          161.6916
#&gt; 76      B PERMDISP          161.3637
#&gt; 77      B PERMDISP          160.7243
#&gt; 78      B PERMDISP          162.8925
#&gt; 79      B PERMDISP          160.8015
#&gt; 80      B PERMDISP          161.7590
#&gt; 81      B PERMDISP          161.8004
#&gt; 82      B PERMDISP          161.1778
#&gt; 83      B PERMDISP          161.3634
#&gt; 84      B PERMDISP          161.4223
#&gt; 85      B PERMDISP          162.5199
#&gt; 86      B PERMDISP          161.3039
#&gt; 87      B PERMDISP          161.4728
#&gt; 88      B PERMDISP          160.7768
#&gt; 89      B PERMDISP          161.7114
#&gt; 90      B PERMDISP          162.3565
#&gt; 91      B PERMDISP          161.3105
#&gt; 92      B PERMDISP          161.0042
#&gt; 93      B PERMDISP          161.4582
#&gt; 94      B PERMDISP          161.9629
#&gt; 95      B PERMDISP          161.2433
#&gt; 96      B PERMDISP          161.8619
#&gt; 97      B PERMDISP          160.9686
#&gt; 98      B PERMDISP          161.7675
#&gt; 99      B PERMDISP          161.2074
#&gt; 100     B PERMDISP          160.5961</div><div class='input'>
<span class='co'># Extract PERMDISP table</span>
<span class='va'>permdispR</span><span class='op'>$</span><span class='va'>permdisp.global_test</span>
</div><div class='output co'>#&gt;           Df    Sum Sq   Mean Sq        F Pr(&gt;F)
#&gt; Groups     1  1.214908 1.2149079 3.387661 0.0642
#&gt; Residuals 98 35.145482 0.3586274       NA     NA</div><div class='input'>
<span class='co'># Plot sample distances to group central medians</span>
<span class='co'>#run pca with truncated SVD (PCA 1 x PCA 2)</span>
<span class='va'>pcaR1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='smart_pca.html'>smart_pca</a></span><span class='op'>(</span>snp_data <span class='op'>=</span> <span class='va'>pathToGenoFile</span>, sample_group <span class='op'>=</span> <span class='va'>my_groups</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Checking argument options selected...</span></div><div class='output co'>#&gt; <span class='message'>Argument options are correct...</span></div><div class='output co'>#&gt; <span class='message'>Loading data...</span></div><div class='output co'>#&gt; <span class='message'>Imported 10000 SNP by 100 sample genotype matrix</span></div><div class='output co'>#&gt; <span class='message'>Time elapsed: 0h 0m 0s</span></div><div class='output co'>#&gt; <span class='message'>Filtering data...</span></div><div class='output co'>#&gt; <span class='message'>No samples projected after PCA computation</span></div><div class='output co'>#&gt; <span class='message'>10000 SNPs included in PCA computation</span></div><div class='output co'>#&gt; <span class='message'>1 SNPs omitted from PCA computation</span></div><div class='output co'>#&gt; <span class='message'>100 samples included in PCA computation</span></div><div class='output co'>#&gt; <span class='message'>Completed data filtering</span></div><div class='output co'>#&gt; <span class='message'>Time elapsed: 0h 0m 0s</span></div><div class='output co'>#&gt; <span class='message'>Scanning for invariant SNPs...</span></div><div class='output co'>#&gt; <span class='message'>Scan complete: no invariant SNPs found</span></div><div class='output co'>#&gt; <span class='message'>Time elapsed: 0h 0m 0s</span></div><div class='output co'>#&gt; <span class='message'>Checking for missing values...</span></div><div class='output co'>#&gt; <span class='message'>6341 SNPs contain missing values</span></div><div class='output co'>#&gt; <span class='message'>Imputing SNPs with missing values...</span></div><div class='output co'>#&gt; <span class='message'>Imputation with means completed: 10058 missing values imputed</span></div><div class='output co'>#&gt; <span class='message'>Time elapsed: 0h 0m 0s</span></div><div class='output co'>#&gt; <span class='message'>Scaling values by SNP...</span></div><div class='output co'>#&gt; <span class='message'>Centering and scaling by drift dispersion...</span></div><div class='output co'>#&gt; <span class='message'>Completed scaling using drift</span></div><div class='output co'>#&gt; <span class='message'>Time elapsed: 0h 0m 0s</span></div><div class='output co'>#&gt; <span class='message'>Computing singular value decomposition using RSpectra...</span></div><div class='output co'>#&gt; <span class='message'>Completed singular value decomposition using RSpectra</span></div><div class='output co'>#&gt; <span class='message'>Time elapsed: 0h 0m 1s</span></div><div class='output co'>#&gt; <span class='message'>Extracting eigenvalues and eigenvectors...</span></div><div class='output co'>#&gt; <span class='message'>Eigenvalues and eigenvectors extracted</span></div><div class='output co'>#&gt; <span class='message'>Time elapsed: 0h 0m 1s</span></div><div class='output co'>#&gt; <span class='message'>Tabulating PCA outputs...</span></div><div class='output co'>#&gt; <span class='message'>Completed tabulations of PCA outputs...</span></div><div class='input'><span class='co'>#compute Euclidean inter-sample distances in PCA space (triangular matrix)</span>
<span class='va'>snp_eucli</span> <span class='op'>&lt;-</span> <span class='fu'>vegan</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/vegan/man/vegdist.html'>vegdist</a></span><span class='op'>(</span><span class='va'>pcaR1</span><span class='op'>$</span><span class='va'>pca.sample_coordinates</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"PC1"</span>,<span class='st'>"PC2"</span><span class='op'>)</span><span class='op'>]</span>, method <span class='op'>=</span> <span class='st'>"euclidean"</span><span class='op'>)</span>
<span class='co'>#calculate spatial medians</span>
<span class='va'>disMed</span> <span class='op'>&lt;-</span> <span class='fu'>vegan</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/vegan/man/betadisper.html'>betadisper</a></span><span class='op'>(</span>d <span class='op'>=</span> <span class='va'>snp_eucli</span>, group <span class='op'>=</span> <span class='va'>my_groups</span><span class='op'>)</span>; <span class='va'>disMed</span>
</div><div class='output co'>#&gt; 
#&gt; 	Homogeneity of multivariate dispersions
#&gt; 
#&gt; Call: vegan::betadisper(d = snp_eucli, group = my_groups)
#&gt; 
#&gt; No. of Positive Eigenvalues: 2
#&gt; No. of Negative Eigenvalues: 0
#&gt; 
#&gt; Average distance to median:
#&gt;     A     B 
#&gt; 21.38 23.66 
#&gt; 
#&gt; Eigenvalues for PCoA axes:
#&gt; PCoA1 PCoA2 
#&gt; 31798 31460 </div><div class='input'><span class='co'>#plot</span>
<span class='va'>oldpar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>0.1</span><span class='op'>)</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>disMed</span>, las <span class='op'>=</span><span class='fl'>2</span>, cex.axis <span class='op'>=</span> <span class='fl'>2</span>, cex.main <span class='op'>=</span> <span class='fl'>1.5</span>, horizontal <span class='op'>=</span> <span class='cn'>TRUE</span>, varwidth <span class='op'>=</span> <span class='cn'>TRUE</span>,
   col <span class='op'>=</span> <span class='va'>cols</span>, xlab <span class='op'>=</span> <span class='st'>""</span>, ylab <span class='op'>=</span> <span class='st'>""</span>, main <span class='op'>=</span> <span class='st'>"Sample distance to group spatial medians"</span><span class='op'>)</span>
</div><div class='img'><img src='smart_permdisp-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>oldpar</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Salvador Herrando-Perez, Christian Huber.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


